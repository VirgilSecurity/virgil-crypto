<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Virgil Security Crypto library: include/virgil/crypto/pythia/virgil_pythia_c.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Virgil Security Crypto library
   &#160;<span id="projectnumber">2.6.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_f80a41a2d00095bbb1bf128decb04ec8.html">include</a></li><li class="navelem"><a class="el" href="dir_52f50fdd245271ed4c9717d774b583fa.html">virgil</a></li><li class="navelem"><a class="el" href="dir_bf6942788d6b5c8d9dc722c07cc55dd1.html">crypto</a></li><li class="navelem"><a class="el" href="dir_4269b6d5f92858745ae49e56383f571e.html">pythia</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">virgil_pythia_c.h File Reference<div class="ingroups"><a class="el" href="group__pythia.html">Pythia</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Provides C interface to the feature Pythia.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;pythia_buf.h&quot;</code><br/>
<code>#include &quot;pythia_buf_sizes.h&quot;</code><br/>
</div>
<p><a href="virgil__pythia__c_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5305908e816192f24394d0bdfd096940"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="virgil__pythia__c_8h.html#a5305908e816192f24394d0bdfd096940">virgil_pythia_blind</a> (const pythia_buf_t *password, pythia_buf_t *blinded_password, pythia_buf_t *blinding_secret)</td></tr>
<tr class="memdesc:a5305908e816192f24394d0bdfd096940"><td class="mdescLeft">&#160;</td><td class="mdescRight">Blinds password.  <a href="#a5305908e816192f24394d0bdfd096940">More...</a><br/></td></tr>
<tr class="separator:a5305908e816192f24394d0bdfd096940"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1eea38319832b9ea92b1fa865d2676b5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="virgil__pythia__c_8h.html#a1eea38319832b9ea92b1fa865d2676b5">virgil_pythia_deblind</a> (const pythia_buf_t *transformed_password, const pythia_buf_t *blinding_secret, pythia_buf_t *deblinded_password)</td></tr>
<tr class="memdesc:a1eea38319832b9ea92b1fa865d2676b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deblinds transformed_password value with previously returned blinding_secret from <a class="el" href="virgil__pythia__c_8h.html#a5305908e816192f24394d0bdfd096940" title="Blinds password. ">virgil_pythia_blind()</a>.  <a href="#a1eea38319832b9ea92b1fa865d2676b5">More...</a><br/></td></tr>
<tr class="separator:a1eea38319832b9ea92b1fa865d2676b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa00b4fa9ecba77b64541d7f6dabf38d9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="virgil__pythia__c_8h.html#aa00b4fa9ecba77b64541d7f6dabf38d9">virgil_pythia_compute_transformation_key_pair</a> (const pythia_buf_t *transformation_key_id, const pythia_buf_t *pythia_secret, const pythia_buf_t *pythia_scope_secret, pythia_buf_t *transformation_private_key, pythia_buf_t *transformation_public_key)</td></tr>
<tr class="memdesc:aa00b4fa9ecba77b64541d7f6dabf38d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes transformation private and public key.  <a href="#aa00b4fa9ecba77b64541d7f6dabf38d9">More...</a><br/></td></tr>
<tr class="separator:aa00b4fa9ecba77b64541d7f6dabf38d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d98b559cb190c7c6c9bdd1b15078324"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="virgil__pythia__c_8h.html#a3d98b559cb190c7c6c9bdd1b15078324">virgil_pythia_transform</a> (const pythia_buf_t *blinded_password, const pythia_buf_t *tweak, const pythia_buf_t *transformation_private_key, pythia_buf_t *transformed_password, pythia_buf_t *transformed_tweak)</td></tr>
<tr class="memdesc:a3d98b559cb190c7c6c9bdd1b15078324"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transforms blinded password using the private key, generated from pythia_secret + pythia_scope_secret.  <a href="#a3d98b559cb190c7c6c9bdd1b15078324">More...</a><br/></td></tr>
<tr class="separator:a3d98b559cb190c7c6c9bdd1b15078324"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a256326da92940592b99b5a3b867e7ec0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="virgil__pythia__c_8h.html#a256326da92940592b99b5a3b867e7ec0">virgil_pythia_prove</a> (const pythia_buf_t *transformed_password, const pythia_buf_t *blinded_password, const pythia_buf_t *transformed_tweak, const pythia_buf_t *transformation_private_key, const pythia_buf_t *transformation_public_key, pythia_buf_t *proof_value_c, pythia_buf_t *proof_value_u)</td></tr>
<tr class="memdesc:a256326da92940592b99b5a3b867e7ec0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates proof that server possesses secret values that were used to transform password.  <a href="#a256326da92940592b99b5a3b867e7ec0">More...</a><br/></td></tr>
<tr class="separator:a256326da92940592b99b5a3b867e7ec0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff285342fdc1026f8edd26422b75d964"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="virgil__pythia__c_8h.html#aff285342fdc1026f8edd26422b75d964">virgil_pythia_verify</a> (const pythia_buf_t *transformed_password, const pythia_buf_t *blinded_password, const pythia_buf_t *tweak, const pythia_buf_t *transformation_public_key, const pythia_buf_t *proof_value_c, const pythia_buf_t *proof_value_u, int *verified)</td></tr>
<tr class="memdesc:aff285342fdc1026f8edd26422b75d964"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies the output of <a class="el" href="virgil__pythia__c_8h.html#a3d98b559cb190c7c6c9bdd1b15078324" title="Transforms blinded password using the private key, generated from pythia_secret + pythia_scope_secret...">virgil_pythia_transform()</a>.  <a href="#aff285342fdc1026f8edd26422b75d964">More...</a><br/></td></tr>
<tr class="separator:aff285342fdc1026f8edd26422b75d964"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6a29659687c7883af4ca5c9e083005b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="virgil__pythia__c_8h.html#ac6a29659687c7883af4ca5c9e083005b">virgil_pythia_get_password_update_token</a> (const pythia_buf_t *previous_transformation_private_key, const pythia_buf_t *new_transformation_private_key, pythia_buf_t *password_update_token)</td></tr>
<tr class="memdesc:ac6a29659687c7883af4ca5c9e083005b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotates old transformation key to new transformation key.  <a href="#ac6a29659687c7883af4ca5c9e083005b">More...</a><br/></td></tr>
<tr class="separator:ac6a29659687c7883af4ca5c9e083005b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d050c317452bb5b9de0ae7ba4b2dc2b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="virgil__pythia__c_8h.html#a8d050c317452bb5b9de0ae7ba4b2dc2b">virgil_pythia_update_deblinded_with_token</a> (const pythia_buf_t *deblinded_password, const pythia_buf_t *password_update_token, pythia_buf_t *updated_deblinded_password)</td></tr>
<tr class="memdesc:a8d050c317452bb5b9de0ae7ba4b2dc2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates previously stored deblinded_password with password_update_token.  <a href="#a8d050c317452bb5b9de0ae7ba4b2dc2b">More...</a><br/></td></tr>
<tr class="separator:a8d050c317452bb5b9de0ae7ba4b2dc2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Provides C interface to the feature Pythia. </p>
<p>Copyright (C) 2015-2018 Virgil Security Inc.</p>
<p>All rights reserved.</p>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p>
<p>(1) Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</p>
<p>(2) Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</p>
<p>(3) Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</p>
<p>THIS SOFTWARE IS PROVIDED BY THE AUTHOR ''AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
<p>Lead Maintainer: Virgil Security Inc. <a href="#" onclick="location.href='mai'+'lto:'+'sup'+'po'+'rt@'+'vi'+'rgi'+'ls'+'ecu'+'ri'+'ty.'+'co'+'m'; return false;">suppo<span style="display: none;">.nosp@m.</span>rt@v<span style="display: none;">.nosp@m.</span>irgil<span style="display: none;">.nosp@m.</span>secu<span style="display: none;">.nosp@m.</span>rity.<span style="display: none;">.nosp@m.</span>com</a> </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a5305908e816192f24394d0bdfd096940"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int virgil_pythia_blind </td>
          <td>(</td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pythia_buf_t *&#160;</td>
          <td class="paramname"><em>blinded_password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pythia_buf_t *&#160;</td>
          <td class="paramname"><em>blinding_secret</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Blinds password. </p>
<p>Turns password into a pseudo-random string. This step is necessary to prevent 3rd-parties from knowledge of end user's password.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">password</td><td>- end user's password. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">blinded_password</td><td>- G1 password obfuscated into a pseudo-random string. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">blinding_secret</td><td>- BN random value used to blind user's password.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if succeeded, -1 otherwise </dd></dl>

</div>
</div>
<a class="anchor" id="aa00b4fa9ecba77b64541d7f6dabf38d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int virgil_pythia_compute_transformation_key_pair </td>
          <td>(</td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>transformation_key_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>pythia_secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>pythia_scope_secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pythia_buf_t *&#160;</td>
          <td class="paramname"><em>transformation_private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pythia_buf_t *&#160;</td>
          <td class="paramname"><em>transformation_public_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes transformation private and public key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">transformation_key_id</td><td>- ensemble key ID used to enclose operations in subsets. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pythia_secret</td><td>- global common for all secret random Key. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pythia_scope_secret</td><td>- ensemble secret generated and versioned transparently. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">transformation_private_key</td><td>- BN transformation_private_key Pythia's private key which was generated using pythia_secret and pythia_scope_secret. This key is used to emit proof tokens (proof_value_c, proof_value_u). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">transformation_public_key</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if succeeded, -1 otherwise </dd></dl>

</div>
</div>
<a class="anchor" id="a1eea38319832b9ea92b1fa865d2676b5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int virgil_pythia_deblind </td>
          <td>(</td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>transformed_password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>blinding_secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pythia_buf_t *&#160;</td>
          <td class="paramname"><em>deblinded_password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deblinds transformed_password value with previously returned blinding_secret from <a class="el" href="virgil__pythia__c_8h.html#a5305908e816192f24394d0bdfd096940" title="Blinds password. ">virgil_pythia_blind()</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">transformed_password</td><td>- GT transformed password from <a class="el" href="virgil__pythia__c_8h.html#a3d98b559cb190c7c6c9bdd1b15078324" title="Transforms blinded password using the private key, generated from pythia_secret + pythia_scope_secret...">virgil_pythia_transform()</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">blinding_secret</td><td>- BN value that was generated in <a class="el" href="virgil__pythia__c_8h.html#a5305908e816192f24394d0bdfd096940" title="Blinds password. ">virgil_pythia_blind()</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">deblinded_password</td><td>- GT deblinded transformed_password value. This value is not equal to password and is zero-knowledge protected.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if succeeded, -1 otherwise </dd></dl>

</div>
</div>
<a class="anchor" id="ac6a29659687c7883af4ca5c9e083005b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int virgil_pythia_get_password_update_token </td>
          <td>(</td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>previous_transformation_private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>new_transformation_private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pythia_buf_t *&#160;</td>
          <td class="paramname"><em>password_update_token</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotates old transformation key to new transformation key. </p>
<p>Rotates old transformation key to new transformation key and generates password_update_token that can update deblinded_passwords. This action should increment version of the pythia_scope_secret.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">previous_transformation_private_key</td><td>- BN previous transformation private key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">new_transformation_private_key</td><td>- BN new transformation private key </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">password_update_token</td><td>- BN value that allows to update all deblinded passwords (one by one) after server issued new pythia_secret or pythia_scope_secret.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if succeeded, -1 otherwise </dd></dl>

</div>
</div>
<a class="anchor" id="a256326da92940592b99b5a3b867e7ec0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int virgil_pythia_prove </td>
          <td>(</td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>transformed_password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>blinded_password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>transformed_tweak</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>transformation_private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>transformation_public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pythia_buf_t *&#160;</td>
          <td class="paramname"><em>proof_value_c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pythia_buf_t *&#160;</td>
          <td class="paramname"><em>proof_value_u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates proof that server possesses secret values that were used to transform password. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">transformed_password</td><td>- GT transformed password from <a class="el" href="virgil__pythia__c_8h.html#a3d98b559cb190c7c6c9bdd1b15078324" title="Transforms blinded password using the private key, generated from pythia_secret + pythia_scope_secret...">virgil_pythia_transform()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">blinded_password</td><td>- G1 blinded password from <a class="el" href="virgil__pythia__c_8h.html#a5305908e816192f24394d0bdfd096940" title="Blinds password. ">virgil_pythia_blind()</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">transformed_tweak</td><td>- G2 transformed tweak from <a class="el" href="virgil__pythia__c_8h.html#a3d98b559cb190c7c6c9bdd1b15078324" title="Transforms blinded password using the private key, generated from pythia_secret + pythia_scope_secret...">virgil_pythia_transform()</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">transformation_private_key</td><td>- BN transformation private key from <a class="el" href="virgil__pythia__c_8h.html#a3d98b559cb190c7c6c9bdd1b15078324" title="Transforms blinded password using the private key, generated from pythia_secret + pythia_scope_secret...">virgil_pythia_transform()</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">transformation_public_key</td><td>- G1 public key corresponding to transformation_private_key value. This value is exposed to the client so he can verify, that each and every Prove operation returns exactly the same value of transformation_public_key. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">proof_value_c</td><td>- BN first part of proof that transformed_password was created using transformation_private_key. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">proof_value_u</td><td>- BN second part of proof that transformed_password was created using transformation_private_key.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if succeeded, -1 otherwise </dd></dl>

</div>
</div>
<a class="anchor" id="a3d98b559cb190c7c6c9bdd1b15078324"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int virgil_pythia_transform </td>
          <td>(</td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>blinded_password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>tweak</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>transformation_private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pythia_buf_t *&#160;</td>
          <td class="paramname"><em>transformed_password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pythia_buf_t *&#160;</td>
          <td class="paramname"><em>transformed_tweak</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transforms blinded password using the private key, generated from pythia_secret + pythia_scope_secret. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">blinded_password</td><td>- G1 password obfuscated into a pseudo-random string. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tweak</td><td>- some random value used to transform a password. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">transformation_private_key</td><td>- BN transformation private key. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">transformed_password</td><td>- GT blinded password, protected using server secret (transformation private key + tweak). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">transformed_tweak</td><td>- G2 tweak value turned into an elliptic curve point. This value is used by Prove() operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if succeeded, -1 otherwise </dd></dl>

</div>
</div>
<a class="anchor" id="a8d050c317452bb5b9de0ae7ba4b2dc2b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int virgil_pythia_update_deblinded_with_token </td>
          <td>(</td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>deblinded_password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>password_update_token</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pythia_buf_t *&#160;</td>
          <td class="paramname"><em>updated_deblinded_password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates previously stored deblinded_password with password_update_token. </p>
<p>After this call, <a class="el" href="virgil__pythia__c_8h.html#a3d98b559cb190c7c6c9bdd1b15078324" title="Transforms blinded password using the private key, generated from pythia_secret + pythia_scope_secret...">virgil_pythia_transform()</a> called with new arguments will return corresponding values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">deblinded_password</td><td>- GT previous deblinded password from <a class="el" href="virgil__pythia__c_8h.html#a1eea38319832b9ea92b1fa865d2676b5" title="Deblinds transformed_password value with previously returned blinding_secret from virgil_pythia_blind...">virgil_pythia_deblind()</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">password_update_token</td><td>- BN password update token from <a class="el" href="virgil__pythia__c_8h.html#ac6a29659687c7883af4ca5c9e083005b" title="Rotates old transformation key to new transformation key. ">virgil_pythia_get_password_update_token()</a> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">updated_deblinded_password</td><td>- GT new deblinded password.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if succeeded, -1 otherwise </dd></dl>

</div>
</div>
<a class="anchor" id="aff285342fdc1026f8edd26422b75d964"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int virgil_pythia_verify </td>
          <td>(</td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>transformed_password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>blinded_password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>tweak</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>transformation_public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>proof_value_c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pythia_buf_t *&#160;</td>
          <td class="paramname"><em>proof_value_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>verified</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verifies the output of <a class="el" href="virgil__pythia__c_8h.html#a3d98b559cb190c7c6c9bdd1b15078324" title="Transforms blinded password using the private key, generated from pythia_secret + pythia_scope_secret...">virgil_pythia_transform()</a>. </p>
<p>This operation allows client to verify that the output of <a class="el" href="virgil__pythia__c_8h.html#a3d98b559cb190c7c6c9bdd1b15078324" title="Transforms blinded password using the private key, generated from pythia_secret + pythia_scope_secret...">virgil_pythia_transform()</a> is correct, assuming that client has previously stored tweak.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">transformed_password</td><td>- GT transformed password from <a class="el" href="virgil__pythia__c_8h.html#a3d98b559cb190c7c6c9bdd1b15078324" title="Transforms blinded password using the private key, generated from pythia_secret + pythia_scope_secret...">virgil_pythia_transform()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">blinded_password</td><td>- G1 blinded password from <a class="el" href="virgil__pythia__c_8h.html#a5305908e816192f24394d0bdfd096940" title="Blinds password. ">virgil_pythia_blind()</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tweak</td><td>- tweak from <a class="el" href="virgil__pythia__c_8h.html#a3d98b559cb190c7c6c9bdd1b15078324" title="Transforms blinded password using the private key, generated from pythia_secret + pythia_scope_secret...">virgil_pythia_transform()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">transformation_public_key</td><td>- G1 transformation public key from pythia_prove </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">proof_value_c</td><td>- BN proof value C from pythia_prove </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">proof_value_u</td><td>- BN proof value U from pythia_prove </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">verified</td><td>- 0 if verification failed, not 0 - otherwise</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if succeeded, -1 otherwise </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
